var si = 0; function eliminar(t) { t.preventDefault, $.ajax({ url: "WS/WSVenta.asmx/quitarDetalle", data: '{ "id":"' + t + '"}', contentType: "application/json; utf-8", dataType: "json", type: "POST", success: function (t) { $("#grvLista tbody").remove(), $("#grvLista tr").remove(), $("#grvLista td").remove(); let e, o = $("#grvLista"), n = $("<thead/>").append("<tr><th>Producto</th><th>Cantidad</th><th>Total</th><td></td>"); $(o).append(n), $(o).append("<tbody/>"); let a = 0; for (var d = 0; d < t.d.length; d++) { a += t.d[d].total, e = document.createElement("tr"); let n = "<td>" + t.d[d].Tipo + "</td><td>" + t.d[d].cantidad + "</td><td>" + t.d[d].total + '</td><td><button type="button" OnClick="eliminar(' + t.d[d].producto + ')" class="btn btn-danger">Eliminar</button></td>'; e.innerHTML = n, $(o).children("tbody").append(e) } $("#contenido_contenido_lbltotal").html(a), $("#grvLista").DataTable(), console.log(t) }, error: function (t) { console.log(t) } }) } $(document).ready(function nombres(e) { $("#frm").validate({ rules: { ctl00$ctl00$contenido$contenido$txtCantidad: { required: !0 } }, messages: { ctl00$ctl00$contenido$contenido$txtCantidad: { required: "Por favor, ingrese una Cantidad" } } }), e.preventDefault, $.ajax({ url: "WS/WSArticulos.asmx/GetNombres", data: {}, contentType: "application/json; utf-8", dataType: "json", type: "POST", success: function (data) { var models = "string" == typeof data.d ? eval("(" + data.d + ") ") : data.d; $("#contenido_contenido_CboxProducto").get(0).options.length = 0; for (var i = 0; i < models.length; i++) { var val = models[i]; $("#contenido_contenido_CboxProducto").get(0).options[$("#contenido_contenido_CboxProducto").get(0).options.length] = new Option(val) } console.log(data) }, error: function (t) { console.log(t) } }) }), $(document).ready(function () { $("#frm").validate({ rules: { ctl00$ctl00$contenido$contenido$txtCantidad: { required: !0 } }, messages: { ctl00$ctl00$contenido$contenido$txtCantidad: { required: "Por favor, ingrese una Cantidad" } } }), $("#contenido_contenido_btnAgregar").click(function (t) { t.preventDefault(); var e = $("#contenido_contenido_CboxProducto").val(), o = $("#contenido_contenido_txtCantidad").val(); o > 0 ? $.ajax({ url: "WS/WSVenta.asmx/detalle", data: '{ "producto":"' + e + '", "Cantidad": "' + o + '"}', contentType: "application/json; utf-8", dataType: "json", type: "POST", success: function (t) { if (null != t) { $("#grvLista tbody").remove(), $("#grvLista tr").remove(), $("#grvLista td").remove(); let o, n = $("#grvLista"), a = $("<thead/>").append("<tr><th>Producto</th><th>Cantidad</th><th>Total</th><td></td>"); $(n).append(a), $(n).append("<tbody/>"); let d = 0; for (var e = 0; e < t.d.length; e++) { d += t.d[e].total, o = document.createElement("tr"); let a = "<td>" + t.d[e].Tipo + "</td><td>" + t.d[e].cantidad + "</td><td>" + t.d[e].total + '</td><td><button type="button" OnClick="eliminar(' + t.d[e].producto + ')" class="btn btn-danger">Eliminar</button></td>'; o.innerHTML = a, $(n).children("tbody").append(o) } $("#grvLista thead tr th").each(function (t) { var e = $(this).text(); $(this).html('<input type="text" placeholder="Search ' + e + '" />'), $("input", this).on("keyup change", function () { table.column(t).search() !== this.value && table.destroy().column(t).search(this.value).draw() }) }), $("#grvLista thead tr th").each(function (t) { var e = $(this).text(); $(this).html('<input type="text" placeholder="Search ' + e + '" />'), $("input", this).on("keyup change", function (e) { $("#grvLista").DataTable().column(t).search() !== this.value && 13 == e.keyCode && ($("#grvLista").DataTable({ destroy: !0, orderCellsTop: !0, fixedHeader: !0 }).column(t).search(this.value).draw(), console.log("fun")) }) }), $("#grvLista").DataTable({ destroy: !0, orderCellsTop: !0, fixedHeader: !0 }), $("#contenido_contenido_lbltotal").html(d), console.log(t) } else $("#mensaje").html('<button type="button" class="close" data-dismiss="alert" >&times;</button><strong > revise los datos </strong >'), $("#mensaje").show() }, error: function (t) { $("#mensaje").html('<button type="button" class="close" data-dismiss="alert" >&times;</button><strong > revise los datos </strong >'), $("#mensaje").show(), console.log(t) } }) : ($("#mensaje").html('<button type="button" class="close" data-dismiss="alert" >&times;</button><strong > la cantidad debe ser mayor a 0 </strong >'), $("#mensaje").show()) }) }), $(document).ready(function () { $("#frm").validate({ rules: { ctl00$ctl00$contenido$contenido$txtCantidad: { required: !0 } }, messages: { ctl00$ctl00$contenido$contenido$txtCantidad: { required: "Por favor, ingrese una Cantidad" } } }), $("#contenido_contenido_btnAceptar").click(function (t) { t.preventDefault(); var e = $("#contenido_contenido_txtDescripcion").val(), o = $("#contenido_contenido_lbltotal").html(); $.ajax({ url: "WS/WSVenta.asmx/Agregar", data: '{"Total":"' + o + '", "Descripcion": "' + e + '"}', contentType: "application/json; utf-8", dataType: "json", type: "POST", success: function (t) { sessionStorage.setItem("indx", null), sessionStorage.setItem("accion", "Venta"), location.href = "index.html", console.log(t) }, error: function (t) { $("#mensaje").html('<button type="button" class="close" data-dismiss="alert" >&times;</button><strong > a acurrido un error </strong >'), $("#mensaje").show(), console.log(t) } }) }) });